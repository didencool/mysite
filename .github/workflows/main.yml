# .github/workflows/main.yml
name: News Aggregator Pipeline

on:
  # –ó–∞–ø—É—Å–∫–∞—Ç–∏ –≤—Ä—É—á–Ω—É
  workflow_dispatch:
  # –ó–∞–ø—É—Å–∫–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —â–æ–¥–Ω—è –æ 00:00 (UTC)
  schedule:
    - cron: '0 0 * * *' 
  # –ó–∞–ø—É—Å–∫–∞—Ç–∏ –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É push –¥–æ –≥—ñ–ª–∫–∏ main
  push:
    branches:
      - main

jobs:
  run_pipeline:
    runs-on: ubuntu-latest

    steps:
    - name: ‚¨áÔ∏è Checkout code
      uses: actions/checkout@v4

    - name: üêç Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: üì¶ Install dependencies
      run: |
        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
        pip install -r requirements.txt # <--- –í–ò–ö–û–†–ò–°–¢–û–í–£–Ñ–ú–û requirements.txt

    - name: üöÄ Run News Script
      run: |
        # –ó–∞–ø—É—Å–∫ –≤–∞—à–æ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        python __main__.py

    - name: üíæ Commit & Push New Data
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        # –í–∞—à —Å–∫—Ä–∏–ø—Ç __main__.py –ø–æ–≤–∏–Ω–µ–Ω –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ data.json
        files: data.json 
        commit_message: "chore(data): Automated update of news data"
